<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
<title>SvgEditor</title>
<style>
*,body {
box-sizing:border-box;
margin:0;
padding: 0px;
background: #ccc;
}
#resizable {
overflow:hidden;
width: 300px;
min-width: 100px;
max-width: 100vw;
min-height: 50px;
max-height: 93vh;
background: #f9f9f9;
position: relative;
}
#handle{
background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' shape-rendering='geometricPrecision' text-rendering='geometricPrecision' image-rendering='optimizeQuality' fill-rule='evenodd' clip-rule='evenodd' viewBox='0 0 512 512'%3E%3Cpath fill-rule='nonzero' d='M318.633 104.048h-49.644v94.774c22.158 5.014 39.533 22.56 44.319 44.772h94.644v-78.986L512 256l-104.048 91.392V268.989h-94.774c-4.968 21.952-22.237 39.221-44.189 44.189v94.774h78.403L256 512l-91.392-104.048H243.594v-94.644c-22.212-4.786-39.758-22.161-44.772-44.319h-94.774v78.403L0 256l104.048-91.392V243.594h94.644c4.83-22.419 22.483-40.072 44.902-44.902v-94.644h-78.986L256 0l91.392 104.048h-28.759z'/%3E%3C/svg%3E");
color:rgba(0,0,0,0.1);
width:30px;
height:30px;
position: absolute;
right:0;
bottom:0;
cursor: se-resize;
touch-action: none;
border:2px solid #fff;
border-radius: 4px;
}
#sizeDisplay {
position: absolute;
top: 5px;
left: 5px;
background: rgba(0,0,0,0.6);
color: #fff;
padding: 2px 6px;
font-size: 12px;
border-radius: 2px;
pointer-events: none;
}
nav{
display:flex;
position:fixed;
left:0;bottom:0;
width:100%;
}
nav button,
.toggle-label{
text-align:center;
flex:1;display:inline-block;
padding: 8px;
background-color: #007BFF;
color: white;
cursor: pointer;
border-radius: 4px;
border:2px solid #ccc;
font-size:16px;
}
.toggle-label::after{content:"⟱⟱⟱";}
:root, html, body {
width: 100vw;
height: 100vh;
box-sizing: border-box;
padding: 0;
margin: 0;
}
input {
width:100%;
margin: 0;
padding: 5px 0;
}
#svg{
box-sizing: border-box;
background:#fff;
}
#toggle {
display: none;
}
/* Content to show/hide */
.toggle-content {
display:none;
background:rgba(0,0,0,0.6);
box-sizing: border-box;
width:100%;
margin:0px;
padding:20px;
border-radius: 5px;
}
.range-slider,.range-value{
background:transparent;
color:#fff;

}
/* Show content when checkbox is checked */
#toggle:checked + .toggle-label + .toggle-content {
display: block;
}
#toggle:checked + .toggle-label::after{content:"⟰⟰⟰";}

#display{
pisition:relative;
width:300px;
min-width: 100px;
max-width: 100vw;
color:coral;
}
#text{
line-height:8px;
width:300px;
min-width: 100px;
max-width: 100vw;
padding:5px;
background:rgba(0,0,0,0.8);
color:coral;
font-size:6px;
white-space:pre-wrap;

}
#notif{
margin:10px;
position:absolute;
background:rgba(0,0,0,0.7);
color:#fff;
}
</style>
<script src='../jquery.js'></script>
</head>
<body>
<div id="resizable">
<div id="sizeDisplay"></div>
<div id="handle">▒</div>

<svg id="svg" width="300" height="200">
<path id="path" stroke="black" stroke-width="5" fill="none"/>
<circle id="circle" cx="0" cy="0" r="5" fill="orange">
<animateMotion dur="8" repeatCount="indefinite">
<mpath href="#path" />
</animateMotion>
</circle>
</svg>

</div>
<div id="picker"></div>
<nav>
<button id="copy">Copy</button>
<button id="download">Download</button>
<button id="reset">Clear</button>
<input type="checkbox" id="toggle">
<label for="toggle" class="toggle-label"> </label>

<div id="tools" class="toggle-content" style="position: fixed; left: 0; top: 0; z-index: 1;">
<div class="range-slider">
line size: <span class="range-value">10</span>
<input class="input-range" type="range" id="pSize" value="5" min="1" max="50">
</div>
<div class="range-slider">
line color: <span class="range-value">10</span>
<input class="input-range" type="range" id="pColor" value="10" min="10" max="99">
</div>
<div class="range-slider">
circle size: <span class="range-value">5</span>
<input class="input-range" type="range" id="circleR" value="5" min="1" max="50">
</div>
<div class="range-slider">
circle Color: <span class="range-value">10</span>
<input class="input-range" type="range" id="cColor" value="10" min="10" max="99">
</div>
<div class="range-slider">
durasi: <span class="range-value">5</span>
<input class="input-range" type="range" id="dur" value="5" min="0.1" max="9.9">
</div>
</nav>
<div id="display">
<p id="notif"></p>
<p id="text"></p>
<p id="panjang"></p></div>


</div>
<script>
const svg = $('#svg')[0];
const $resizable = $('#resizable');
const $handle = $('#handle');
let isResizing = false;
let newWidth = $resizable.width();
let newHeight = $resizable.height();
const updateSizeDisplay = () => {
$('#sizeDisplay').text(`${Math.round(newWidth)}px × ${Math.round(newHeight)}px`);
const serializer = new XMLSerializer();
let source = serializer.serializeToString(svg);
$('#text').text(source);
};
const sendSizeAndUpdate = () => {
const data = { width: Math.round(newWidth), height: Math.round(newHeight) };
$.post("http://192.168.43.25:5000/save-size", JSON.stringify(data), null, "json")
.then(() => $.get("http://192.168.43.25:5000/dynamic-html"));
};
const startResize = (e) => {
isResizing = true;
const startX = e.clientX || e.originalEvent.touches[0].clientX;
const startY = e.clientY || e.originalEvent.touches[0].clientY;
const startWidth = $resizable.width();
const startHeight = $resizable.height();
const doResize = (moveEvent) => {
if (!isResizing) return;
const moveX = moveEvent.clientX || moveEvent.originalEvent.touches[0].clientX;
const moveY = moveEvent.clientY || moveEvent.originalEvent.touches[0].clientY;
newWidth = startWidth + (moveX - startX);
newHeight = startHeight + (moveY - startY);
$resizable.css({ width: newWidth, height: newHeight });
$('#svg').attr({ width: Math.round(newWidth), height: Math.round(newHeight) });
$('#display,#text').css({ width: Math.round(newWidth)});

updateSizeDisplay();
};
const stopResize = () => {
isResizing = false;
$(window).off('mousemove touchmove', doResize);
$(window).off('mouseup touchend', stopResize);
updateSizeDisplay();
sendSizeAndUpdate();
};
$(window).on('mousemove touchmove', doResize);
$(window).on('mouseup touchend', stopResize);
};
$('#handle').on('mousedown touchstart', startResize);
updateSizeDisplay();
sendSizeAndUpdate();
$('.input-range').on('input', function(){
$(this).prev('.range-value').text(this.value);
const serializer = new XMLSerializer();
let source = serializer.serializeToString(svg);
$('#text').text(source);
});
let isDrawing = false;
let pathData = '';
$('#reset').click(function() {
pathData = '';
$('#path').attr('d', '');
$('#text').text("");
$('#panjang').text("");
});
const getLocalCoords = (event) => {
  const touch = event.originalEvent.touches ? event.originalEvent.touches[0] : event;
  const svgRect = svg.getBoundingClientRect();
  const x = touch.clientX - svgRect.left;
  const y = touch.clientY - svgRect.top;
  return { x, y };
};

const isInsideSVG = ({ x, y }) => {
  return x >= 0 && y >= 0 && x <= svg.width.baseVal.value && y <= svg.height.baseVal.value;
};

const startDrawing = (event) => {
  const { x, y } = getLocalCoords(event);
  if (!isInsideSVG({ x, y })) return;

  isDrawing = true;
  pathData += `M ${Math.round(x)} ${Math.round(y)}`;
  $('path').attr('d', pathData);
  event.preventDefault();

  const serializer = new XMLSerializer();
  let source = serializer.serializeToString(svg);
  $('#text').text(source);
};
const updatePathLength = () => {
  const path = document.getElementById('path');
  const length = path.getTotalLength();
  $('#panjang').text(`Panjang: ${Math.round(length)}`);

};
const draw = (event) => {
  if (!isDrawing) return;
  const { x, y } = getLocalCoords(event);
  if (!isInsideSVG({ x, y })) return;

  pathData += ` L ${Math.round(x)} ${Math.round(y)}`;
  $('#path').attr('d', pathData);

  const serializer = new XMLSerializer();
  let source = serializer.serializeToString(svg);
  $('#text').text(source);

  updatePathLength(); // ← Tambahkan ini
};
const stopDrawing = () => { isDrawing = false; };
$('#svg').on('touchstart mousedown', startDrawing);
$('#svg').on('touchmove mousemove', draw);
$('#svg').on('touchend touchcancel mouseup mouseleave', stopDrawing);
$('#pSize').on('input', function() { $('#path').attr('stroke-width', this.value); });
$('#pColor').on('input', function() { $('#path').attr('stroke', '#f'+this.value); });
$('#circleR').on('input', function() { $('circle').attr('r', this.value); });
$('#cColor').on('input', function() { $('circle').attr('fill','#f'+this.value+'f'); });
$('#dur').on('input', function() { $('animateMotion').attr('dur',this.value)});
$('#download').on('click', () => {
const serializer = new XMLSerializer();
let source = serializer.serializeToString(svg);
const blob = new Blob([source], { type: 'image/svg+xml' });
const url = URL.createObjectURL(blob);
const $a = $('<a>').attr('href', url).attr('download', 'image.svg').appendTo('body');
$a[0].click();
$a.remove();
URL.revokeObjectURL(url);
});
$('#copy').on('click', () => {
  navigator.clipboard.writeText($('#text').text());
  $('#notif').text('✅ Berhasil di-copy').fadeIn();

  setTimeout(() => {
$('#notif').fadeOut(() => $(this).text(''));
  }, 2000); // hilang setelah 2 detik, kayak mantan pas lihat saldo
});
</script>
</body>
</html>